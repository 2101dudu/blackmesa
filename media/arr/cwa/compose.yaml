---
services:
  calibre-web-automated:
    image: crocodilestick/calibre-web-automated:V3.1.4
    container_name: calibre-web-automated
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - HARDCOVER_TOKEN=your_hardcover_api_key_here
      - NETWORK_SHARE_MODE=false
      # If you want to force polling mode regardless of share type, set CWA_WATCH_MODE=poll
      # - CWA_WATCH_MODE=poll
      # If running behind multiple proxies (e.g., Cloudflare Tunnel + reverse proxy), set the total number of proxies
      # This ensures proper IP detection for session protection and rate limiting (default: 1)
      # - TRUSTED_PROXY_COUNT=2
      # Skip the automatic library detection/mount at startup. When enabled, the auto-library service will not run.
      # Accepts: true/yes/1 to disable auto-mount (default: false)
      # - DISABLE_LIBRARY_AUTOMOUNT=false
    volumes:
      - ./config:/config
      - /mnt/tank/arr/media/books:/calibre-library
      - /mnt/tank/torrents/media/books:/cwa-book-ingest
    ports:
      - 8083:8083
    restart: unless-stopped
    networks:
      exposed:
        ipv4_address: 172.30.0.164

networks:
  exposed:
    external: true
    name: blackmesa
